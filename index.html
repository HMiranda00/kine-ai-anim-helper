<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Kine AI Anim Helper</title>
  <link rel="stylesheet" href="style.css">
  <meta name="color-scheme" content="dark light">
</head>
<body>
  <main class="app-container">
    <!-- Drag & Drop Overlay -->
    <div class="drag-overlay" id="dragOverlay" style="display: none;">
      <div class="drag-content">
        <div class="drag-icon">üìÅ</div>
        <div class="drag-text">Drop image to add as Start Frame</div>
      </div>
    </div>
    
    <!-- Canvas area - always visible (empty canvases by default) -->
    <div class="canvas-area" id="canvasArea">
      <div class="canvas-container">
        <div class="left-column">
          <div class="frames-group">
          <div class="canvas-frame active" id="startFrame">
          <canvas id="canvasStart" width="512" height="512"></canvas>
          <div class="canvas-upload-btn" id="startUpload"><span class="icon icon-plus"></span></div>
          <div class="image-actions">
            <button class="action-btn btn-download" title="Download"><span class="icon icon-download"></span></button>
            <button class="action-btn btn-delete" title="Delete"><span class="icon icon-delete"></span></button>
          </div>
          <div class="frame-controls">
            <div class="frame-indicator">
              <div class="indicator-dot active"></div>
              <span class="frame-label">Start</span>
              <div class="indicator-dot"></div>
            </div>
          </div>
          </div>
          
          <div class="canvas-frame" id="endFrame">
          <canvas id="canvasEnd" width="512" height="512"></canvas>
          <div class="canvas-upload-btn" id="endUpload"><span class="icon icon-plus"></span></div>
          <div class="image-actions">
            <button class="action-btn btn-download" title="Download"><span class="icon icon-download"></span></button>
            <button class="action-btn btn-delete" title="Delete"><span class="icon icon-delete"></span></button>
          </div>
          <div class="frame-controls">
            <div class="frame-indicator">
              <div class="indicator-dot"></div>
              <span class="frame-label">End</span>
              <div class="indicator-dot active"></div>
            </div>
          </div>
          </div>
          </div>
          
        </div>
        
        <!-- Video preview canvas -->
        <div class="video-preview" id="videoPreview" style="display: none;">
          <video id="videoPlayer" width="300" height="300" controls muted loop playsinline></video>
          <div class="video-label">Video Preview</div>
        </div>
      </div>
    </div>

    <!-- History Gallery (left slide-out) -->
    <div class="history-gallery" id="imageHistory">
      <div class="history-header">
        <span class="history-title">History</span>
        <button class="close-history" id="closeHistoryBtn">√ó</button>
      </div>
      <div class="history-grid" id="historyGrid"></div>
    </div>

    <!-- Footer bar: history + global controls + prompt -->
    <div class="footer-bar">
      <div class="footer-controls">
        <div class="settings-pills">
          <div class="pill-group">
            <select id="aspectRatioSelect" class="setting-pill">
              <option value="1:1">1:1</option>
              <option value="16:9">16:9</option>
              <option value="4:3">4:3</option>
              <option value="21:9">21:9</option>
            </select>
            
            <button id="orientationToggle" class="orientation-toggle" title="Toggle Orientation">
              <span class="orientation-icon"></span>
            </button>
            
            <select id="resolutionSelect" class="setting-pill">
              <option value="small">480p</option>
              <option value="regular">720p</option>
              <option value="big" selected>1080p</option>
            </select>

            <!-- Upscale button -->
            <button id="upscaleBtn" class="setting-pill" title="Upscale 4x">Upscale 4x</button>

            <!-- History pill toggle -->
            <button id="historyToggle" class="setting-pill" title="History">History</button>

            <!-- Settings pill toggle -->
            <button id="settingsToggle" class="setting-pill" title="Settings">Settings</button>

            <!-- Compact Duration Pill (visible only in video mode) -->
            <div class="duration-pill" id="durationPill" style="display: none;">
              <input type="number" id="videoDuration" min="1" max="10" value="5" />
              <span class="suffix">s</span>
            </div>
          </div>
        </div>
        
        <!-- Mode toggle - initially hidden, only shows when both frames exist -->
        <div class="mode-toggle" id="modeToggle" style="display: none;">
          <button class="mode-btn active" data-mode="image">Image</button>
          <button class="mode-btn" data-mode="video">Video</button>
        </div>

        <!-- Video controls moved into pill-group as compact duration pill -->
      </div>

      <div class="prompt-bar">
        <div class="prompt-mode-toggle">
          <button class="prompt-mode-btn active" data-mode="generate">Generate</button>
          <button class="prompt-mode-btn" data-mode="edit">Edit</button>
        </div>
        
        <div class="prompt-content">
          <textarea id="promptInput" placeholder="A cat in a hat..." rows="1"></textarea>
          <div class="prompt-files" id="promptFiles"></div>
        </div>
        <button class="add-btn" id="addBtn"><span class="icon icon-plus"></span></button>
        <button class="play-btn" id="playBtn"><span class="icon icon-arrow"></span></button>
      </div>
    </div>

    <!-- File inputs (hidden) -->
    <input type="file" id="fileInput" accept="image/*" multiple style="display: none;" />
    <input type="file" id="startFileInput" accept="image/*" style="display: none;" />
    <input type="file" id="endFileInput" accept="image/*" style="display: none;" />
  </main>

  <!-- Settings Modal -->
  <div class="modal-overlay" id="settingsOverlay" style="display: none;">
    <div class="settings-modal" role="dialog" aria-modal="true" aria-labelledby="settingsTitle">
      <div class="settings-header">
        <span id="settingsTitle">Settings</span>
        <button class="close-settings" id="closeSettingsBtn" aria-label="Close">√ó</button>
      </div>
      <div class="settings-body">
        <label for="replicateApiKey">Replicate API Key</label>
        <input id="replicateApiKey" type="password" placeholder="r8_..." autocomplete="off" />
        <!-- Proxy URL hidden because it's hardcoded to Supabase -->
        <label for="apiProxyUrl" style="display:none;">API Proxy URL</label>
        <input id="apiProxyUrl" type="url" placeholder="http://localhost:3000/api" autocomplete="off" style="display:none;" />
        <label class="remember-row">
          <input id="rememberApiKey" type="checkbox" /> Remember on this device
        </label>
      </div>
      <div class="settings-actions">
        <button id="saveSettingsBtn" class="setting-pill">Save</button>
        <button id="cancelSettingsBtn" class="setting-pill">Cancel</button>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>


